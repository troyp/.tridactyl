" ╭────────────╮
" │ DnD module │
" ╰────────────╯
definesearch dndb_search https://www.dndbeyond.com/search?q=%s
command: dndjs "Run javascript after loading dnd.c.js file (default COUNT=1)" cujs -r sites/dnd.c.js ; js_count
command: dndjs! "Run javascript after loading dnd.c.js file (default COUNT=null)" cujs -r sites/dnd.c.js ; js_count!

" ───────────────────────────────────────────────────────────────────────────────
" ╭────────────╮
" │ D&D Beyond │
" ╰────────────╯
autocmd DocLoad  https://www\.dndbeyond\.com/ cujs -r sites/dndb.auto.js
autocmd TabEnter https://www\.dndbeyond\.com/ cujs -r sites/dndb.auto.js

command: dndbbind "Bind key for dndbeyond.com" bindurl dndbeyond.com
command: dndbbind: "Bind key with description for dndbeyond.com" bindurl: dndbeyond.com
command: dndbbdoc "Provide a description on a separate line" js ;
command: dndbshowkeys "(show bindings: dndb)" showkeysurl dndbeyond.com

dndbbind: c<C-h> "(show bindings: dndb)" dndbshowkeys c

dndbbind: <enter> "load dndb.auto.js" cujs -r sites/dndb.auto.js
dndbbind: <S-enter> "Jump to heading" cujs jumpToHeading()
dndbbind: <A-enter> "Jump to table" cujs jumpToHeading(".Table-Styles_Table-Title")
dndbbind f jsb sites.dndb.follow()
dndbbind F jsb sites.dndb.follow("-Jb")
dndbbind: <A-Escape> "Close modal" click .fullscreen-modal-close-btn
dndbbind: [[ "Previous page" click .top-prev-page>a
dndbbind: ]] "Next page" click .top-next-page>a
dndbbind: <C-PageDown> "Load More" cujs $1t("button", /load more/i).click()

dndbbind c<C-h> showkeysurl dndbeyond.com c
dndbbind: cb "Goto rpgbot.net" openorsummonc https://rpgbot.net/dnd5/
dndbbind: cc "Lists: open/close row" dndjs dnd.dndb.go()
dndbbind: cf "Click category icon" hint .ddb-search-filter-item-wrapper>.icon
dndbbdoc cv "Toggle collapse Dice Notification"
dndbbind cv hint -Jc .dice_notification_controls__collapse,.dice_notification_controls__uncollapse

" | cl -- dndb/library |
dndbbind: cl<C-h> "(show bindings: dndb/lib)" dndbshowkeys cl
dndbbind: clb "Library/Basic Rules" toposu! https://www.dndbeyond.com/sources/basic-rules
dndbbind: cld "Library/DMG" toposu! https://www.dndbeyond.com/sources/dmg
dndbbind: cll "Library" toposu! https://www.dndbeyond.com/sources#Sourcebooks
dndbbind: clm "Library/Monster Manual" toposu! https://www.dndbeyond.com/sources/mm
dndbbind: clM "Library/Monsters of the Multiverse" toposu! https://www.dndbeyond.com/sources/motm
dndbbind: clp "Library/PHB" toposu! https://www.dndbeyond.com/sources/phb
dndbbind: cls "Library/Sage Advice" toposu! https://www.dndbeyond.com/sources/sac
dndbbind: clS "Library/Sword Coast Adventurer's Guide" toposu! https://www.dndbeyond.com/sources/scag
dndbbind: clt "Library/Tasha's Cauldron of Everything" toposu! https://www.dndbeyond.com/sources/tcoe
dndbbind: clw "Library/Explorer's Guide to Wildemount" toposu! https://www.dndbeyond.com/sources/egtw
dndbbind: clx "Library/Xanathar's" toposu! https://www.dndbeyond.com/sources/xgte

" | cm -- dndb/my |
dndbbind: cm<C-h> "(show bindings: dndb/my)" dndbshowkeys cm
dndbbind: cmc "Goto my characters" toposu! https://www.dndbeyond.com/characters
dndbbind: cmh "Goto my homebrew" toposu! https://www.dndbeyond.com/my-creations

" | co -- dndb/goto |
dndbbind: co<C-h> "(show bindings: dndb/goto)" dndbshowkeys co
dndbbind: coc "Goto cart" toposu! https://www.dndbeyond.com/marketplace/cart
dndbbind: cod "Goto dnd5e.wikidot.com" toposu! http://dnd5e.wikidot.com/
dndbbind: com "Goto marketplace" toposu! https://www.dndbeyond.com/marketplace/sourcebooks
dndbbind: cor "Goto rpgbot.net" toposu! https://rpgbot.net/dnd5/
dndbbind: cos "Goto dnd-spells.com" toposu! https://www.dnd-spells.com/spells
dndbbind: cot "Goto tabletopbuilds.com" toposu! https://tabletopbuilds.com

" | cr -- dndb/rules |
dndbbind: cr<C-h> "(show bindings: dndb/rules)" dndbshowkeys cr
dndbbind: crb "Goto Backgrounds" toposu! https://www.dndbeyond.com/backgrounds
dndbbind: cre "Goto Equipment" toposu! https://www.dndbeyond.com/equipment
dndbbind: crf "Goto Feats" toposu! https://www.dndbeyond.com/feats
dndbbind: cri "Goto Magic Items" toposu! https://www.dndbeyond.com/magic-items
dndbbind: crm "Goto Monsters" toposu! https://www.dndbeyond.com/monsters
dndbbind: crr "Goto Races" toposu! https://www.dndbeyond.com/races
dndbbind: crv "Goto Vehices" toposu! https://www.dndbeyond.com/vehicles

" | crc -- dndb/rules/classes |
dndbbind: crc<C-h> "(show bindings: dndb/rules/class)" dndbshowkeys crc
dndbbind: crc. "Goto Classes" toposu! https://www.dndbeyond.com/classes
dndbbind: crca "Goto Artificer" toposu! https://www.dndbeyond.com/classes/artificer
dndbbind: crcB "Goto Barbarian" toposu! https://www.dndbeyond.com/classes/barbarian
dndbbind: crcb "Goto Bard" toposu! https://www.dndbeyond.com/classes/bard
dndbbind: crcc "Goto Cleric" toposu! https://www.dndbeyond.com/classes/cleric
dndbbind: crcd "Goto Druid" toposu! https://www.dndbeyond.com/classes/druid
dndbbind: crcf "Goto Fighter" toposu! https://www.dndbeyond.com/classes/fighter
dndbbind: crck "Goto Warlock" toposu! https://www.dndbeyond.com/classes/warlock
dndbbind: crcm "Goto Monk" toposu! https://www.dndbeyond.com/classes/monk
dndbbind: crcp "Goto Paladin" toposu! https://www.dndbeyond.com/classes/paladin
dndbbind: crcR "Goto Ranger" toposu! https://www.dndbeyond.com/classes/ranger
dndbbind: crcr "Goto Rogue" toposu! https://www.dndbeyond.com/classes/rogue
dndbbind: crcs "Goto Sorcerer" toposu! https://www.dndbeyond.com/classes/sorcerer
dndbbind: crcw "Goto Wizard" toposu! https://www.dndbeyond.com/classes/wizard
dndbbind: crcW "Goto Warlock" toposu! https://www.dndbeyond.com/classes/warlock

" | crs -- dndb/rules/spells |
dndbbind: crs<C-h> "(show bindings: dndb/rules/spells)" dndbshowkeys crs
dndbbind: crss "Goto Spells" toposu! https://www.dndbeyond.com/spells
dndbbind: crsc "Goto Spells: conjuration" toposu! https://www.dndbeyond.com/spells/school/conjuration
dndbbind: crsd "Goto Spells: divination" toposu! https://www.dndbeyond.com/spells/school/divination
dndbbind: crse "Goto Spells: enchantment" toposu! https://www.dndbeyond.com/spells/school/enchantment
dndbbind: crsi "Goto Spells: illusion" toposu! https://www.dndbeyond.com/spells/school/illusion
dndbbind: crsn "Goto Spells: necromancy" toposu! https://www.dndbeyond.com/spells/school/necromancy
dndbbind: crst "Goto Spells: transmutation" toposu! https://www.dndbeyond.com/spells/school/transmutation
dndbbind: crsv "Goto Spells: evocation" toposu! https://www.dndbeyond.com/spells/school/evocation
dndbbind: crs.a "Goto Spells: class=Artificer" toposu! https://www.dndbeyond.com/spells?filter-class=252717
dndbbind: crs.b "Goto Spells: class=Bard" toposu! https://www.dndbeyond.com/spells?filter-class=1
dndbbind: crs.c "Goto Spells: class=Cleric" toposu! https://www.dndbeyond.com/spells?filter-class=2
dndbbind: crs.d "Goto Spells: class=Druid" toposu! https://www.dndbeyond.com/spells?filter-class=3
dndbbind: crs.k "Goto Spells: class=Warlock" toposu! https://www.dndbeyond.com/spells?filter-class=7
dndbbind: crs.p "Goto Spells: class=Paladin" toposu! https://www.dndbeyond.com/spells?filter-class=4
dndbbind: crs.r "Goto Spells: class=Ranger" toposu! https://www.dndbeyond.com/spells?filter-class=5
dndbbind: crs.s "Goto Spells: class=Sorcerer" toposu! https://www.dndbeyond.com/spells?filter-class=6
dndbbind: crs.w "Goto Spells: class=Wizard" toposu! https://www.dndbeyond.com/spells?filter-class=8
dndbbind: crs.W "Goto Spells: class=Warlock" toposu! https://www.dndbeyond.com/spells?filter-class=7
dndbbind: crs<Space> "Open spell description" fillcmdline_notrail tabopen https://www.dndbeyond.com/spells/

" | cs -- dndb/search |
definesearch dndbspell https://www.dndbeyond.com/spells/%s -
definesearch dndbsearch_spell https://www.dndbeyond.com/spells?filter-class=0&filter-search=%s

dndbbind: cs<C-h> "(show bindings: dndb/search)" dndbshowkeys cs
dndbbind: css "Search" fillcmdline dndb_search tab
dndbbind: csS "Search dndb spells" fillcmdline dndbsearch_spell tab
dndbbind: cs;s "Goto spell description" fillcmdline dndbspell tab

" | ct -- dndb/toggle |
dndbbind: ct<C-h> "(show bindings: dndb/toggle)" dndbshowkeys ct
dndbbind: ctn "Toggle all off" dndjs dnd.dndb.toggleOff()
dndbbind: ctt "Toggle all" dndjs dnd.dndb.toggle()
dndbbind: ctw "Toggle sidebar width" cujs toggleprop($1("div.ct-sidebar").style, "minWidth", "600px")
dndbbind: cty "Toggle all on" dndjs dnd.dndb.toggleOn()

" | cts -- dndb/toggle/sort-by |
dndbbind: cts<C-h> "(show bindings: dndb/toggle/sort-by)" dndbshowkeys cts
dndbbind: ctsc "Toggle sort-by cast time" simjs simulateHtmlMouseEvent($1("[data-sort-by=casting-time]"), "click")
dndbbind: ctsd "Toggle sort-by duration" simjs simulateHtmlMouseEvent($1("[data-sort-by=duration]"), "click")
dndbbind: ctsn "Toggle sort-by name" simjs simulateHtmlMouseEvent($1("[data-sort-by=name]"), "click")
dndbbind: ctsl "Toggle sort-by level" simjs simulateHtmlMouseEvent($1("[data-sort-by=level]"), "click")
dndbbind: ctsr "Toggle sort-by range" simjs simulateHtmlMouseEvent($1("[data-sort-by=range]"), "click")

" | cx -- dndb/misc |
dndbbind: cx<C-h> "(show bindings: dndb/misc)" dndbshowkeys cx
" | cxl -- dndb/misc/list |
dndbbind: cxl<C-h> "(show bindings: dndb/misc/list)" dndbshowkeys cxl
dndbbind: cxlc "Count list entries" cujs $1("ul.listing").children.length | show5
" | cxt -- dndb/misc/table |
dndbbind: cxt<C-h> "(show bindings: dndb/misc/table)" dndbshowkeys cxt
dndbbind: cxtd "Split Damage column of table" dndjs ; hint -Jc table -F t=>dnd.dndb.tableSplitDamageCol(t)

" | cy -- dndb/yank |
dndbbind: cy<C-h> "(show bindings: dndb/yank)" dndbshowkeys cy
dndbbind: cya "Copy all entries" yankall .info a
dndbbind: cyy "Copy entry" cujs yankhint(".info a")

"    ╭────────────────────────────╮
"    │ D&D Beyond Character Sheet │
"    ╰────────────────────────────╯
autocmd DocLoad  https://www\.dndbeyond\.com/characters/ cujs -r sites/dndb.auto.js
autocmd TabEnter https://www\.dndbeyond\.com/characters/ cujs -r sites/dndb.auto.js

command dndbcsheetbind bindurl https://www.dndbeyond.com/characters/[0-9]+
command dndbcsheetbind: bindurl: https://www.dndbeyond.com/characters/[0-9]+

dndbcsheetbind: c<C-h> "(show bindings: dndbcsheet)" dndbcsheetshowkeys c
dndbcsheetbind: <enter> "load dndb.csheet.auto.js" cujs -r sites/dndb.auto.js

dndbcsheetbind: cy<C-h> "(show bindings: dndbcsheet/yank)" dndbcsheetshowkeys cy
dndbcsheetbind: cyy "Yank Content Group" dndbcsheetyankcontentgroup
command dndbcsheetyankcontentgroup dndjs ; hint -Jc .ct-content-group -F e=>dnd.dndb.yankContentGroup()

" | cm -- dndb/my |
dndbcsheetbind: cm<C-h> "(show bindings: dndbcsheet/my)" dndbcsheetshowkeys cm
" | cm -- dndb/my/sheet |
dndbcsheetbind: cms<C-h> "(show bindings: dndbcsheet/my/sheet)" dndbcsheetshowkeys cms
dndbcsheetbind: cmsc "Goto character builder: class" jsb sites.dndb.gotoBuilder("/class/manage")

" ───────────────────────────────────────────────────────────────────────────────
" ╭────────────╮
" │ D&D-Spells │
" ╰────────────╯
command: dndspbind "Bind key for D&D-Spells" bindurl dnd-spells
command: dndspbind: "Bind key with description for D&D-Spells" bindurl: dnd-spells
command: dndspbdoc "Provide a description on a separate line" js ;
command: dndspshowkeys "(show bindings: dndsp)" showkeysurl dnd-spells

dndspbind: c<C-h> "(show bindings: dndsp)" dndspshowkeys c

dndspbind: co<C-h> "(show bindings: dndsp/goto)" dndspshowkeys co
dndspbind: cob "Goto DnDBeyond.com" tabopenorsummonc https://www.dndbeyond.com
dndspbind: cor "Goto rpgbot.net" tabopenorsummonc https://rpgbot.net/dnd5/
dndspbind: cot "Goto TabletopBuilds.com" tabopenorsummonc! https://tabletopbuilds.com

" ───────────────────────────────────────────────────────────────────────────────
" ╭──────────╮
" │ D&D Wiki │
" ╰──────────╯
command: dandwbind "Bind key for D&D Wiki" bindurl dandwiki.com
command: dandwreset "Reset key for D&D Wiki" reseturl dandwiki.com
command: dandwbind: "Bind key with description for D&D Wiki" bindurl: dandwiki.com
command: dandwbdoc "Provide a description on a separate line" js ;
command: dandwshowkeys "(show bindings: dandw)" showkeysurl dandwiki.com

command dandw_js "Run javascript after loading dnd.js file (default COUNT=1)" cujs -r dnd.js ; js_count
command dandw_js! "Run javascript after loading dnd.js file (default COUNT=null)" cujs -r dnd.js ; js_count!

dandwbind: c<C-h> "(show bindings: dandw)" showkeysurl dandwiki.com

dandwbind: cc "Filter Optimized builds: 5e only" dndjs dnd.dandw.filter5e()

" ───────────────────────────────────────────────────────────────────────────────
" ╭───────────────────╮
" │ RPGBot.net - DnD5 │
" ╰───────────────────╯
command rpgbotbind bindurl rpgbot.net
command rpgbotbind: bindurl: rpgbot.net

rpgbotbind c<C-h> showkeysurl rpgbot.net c
rpgbotbind: cb "Goto DnDBeyond.com" openorsummonc https://www.dndbeyond.com
definesearch rpgbot_search https://rpgbot.net/?s=%s

rpgbotbind: cba "Artificer Subclasses" toposu! https://rpgbot.net/dnd5/characters/classes/artificer/subclasses
rpgbotbind: cbB "Barbarian Subclasses" toposu! https://rpgbot.net/dnd5/characters/classes/barbarian/subclasses
rpgbotbind: cca "Goto Artificer Guide" toposu! https://rpgbot.net/dnd5/characters/classes/artificer
rpgbotbind: ccB "Goto Barbarian Guide" toposu! https://rpgbot.net/dnd5/characters/classes/barbarian
rpgbotbind: ccb "Goto Bard Guide" toposu! https://rpgbot.net/dnd5/characters/classes/bard
rpgbotbind: ccc "Goto Cleric Guide" toposu! https://rpgbot.net/dnd5/characters/classes/cleric
rpgbotbind: ccd "Goto Druid Guide" toposu! https://rpgbot.net/dnd5/characters/classes/druid
rpgbotbind: ccf "Goto Fighter Guide" toposu! https://rpgbot.net/dnd5/characters/classes/fighter
rpgbotbind: cck "Goto Warlock Guide" toposu! https://rpgbot.net/dnd5/characters/classes/warlock
rpgbotbind: ccm "Goto Monk Guide" toposu! https://rpgbot.net/dnd5/characters/classes/monk
rpgbotbind: ccp "Goto Paladin Guide" toposu! https://rpgbot.net/dnd5/characters/classes/paladin
rpgbotbind: ccR "Goto Ranger Guide" toposu! https://rpgbot.net/dnd5/characters/classes/ranger
rpgbotbind: ccr "Goto Rogue Guide" toposu! https://rpgbot.net/dnd5/characters/classes/rogue
rpgbotbind: ccs "Goto Sorcerer Guide" toposu! https://rpgbot.net/dnd5/characters/classes/sorcerer
rpgbotbind: ccW "Goto Warlock Guide" toposu! https://rpgbot.net/dnd5/characters/classes/warlock
rpgbotbind: ccw "Goto Wizard Guide" toposu! https://rpgbot.net/dnd5/characters/classes/wizard

" | co -- rpgbot/goto |
rpgbotbind co<C-h> showkeysurl rpgbot.net co
rpgbotbind: cot "Goto tabletopbuilds.com" openorsummonc! https://tabletopbuilds.com

" | co -- rpgbot/search |
rpgbotbind cs<C-h> showkeysurl rpgbot.net cs
rpgbotbind: csb "Search DnDBeyond.com" fillcmdline dndb_search tab
rpgbotbind: css "Search RPGBot.net" fillcmdline rpgbot_search tab
rpgbotbind: cs;s "Goto spell description" fillcmdline dndbspell tab

" | ct -- rpgbot/toggle |
rpgbotbind: ct<C-h> "(show bindings: rpgbot/toggle)" rpgbotshowkeys ct
rpgbotbind: ctw "Toggle width" cujs toggleprop($1("article.article").style, "maxWidth", "1000px")

rpgbotbind: c/b "Bard Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/bard/subclasses
rpgbotbind: c/c "Cleric Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/cleric/subclasses
rpgbotbind: c/d "Druid Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/druid/subclasses
rpgbotbind: c/f "Fighter Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/fighter/subclasses
rpgbotbind: c/m "Monk Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/monk/subclasses
rpgbotbind: c/p "Paladin Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/paladin/subclasses
rpgbotbind: c/R "Ranger Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/ranger/subclasses
rpgbotbind: c/r "Rogue Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/rogue/subclasses
rpgbotbind: c/s "Sorcerer Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/sorcerer/subclasses
rpgbotbind: c/W "Warlock Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/warlock/subclasses
rpgbotbind: c/w "Wizard Subclasses" toposu https://rpgbot.net/dnd5/characters/classes/wizard/subclasses

" ───────────────────────────────────────────────────────────────────────────────
" ╭────────────────────╮
" │ TabletopBuilds.com │
" ╰────────────────────╯
command ttbuildbind bindurl tabletopbuilds.com
command ttbuildbind: bindurl: tabletopbuilds.com

ttbuildbind c<C-h> showkeysurl tabletopbuilds.com c
ttbuildbind: cb "Goto DnDBeyond.com" openorsummonc https://www.dndbeyond.com
ttbuildbind: cc "Load ttbuild.auto.js" cujs -r sites/ttbuild.auto.js
ttbuildbdoc cl "Show final build levels"
ttbuildbind cl cujs cutils.message(getText1("h3,h3>span", {match: /^level 20[: ]/i}), {cmdline: true})


" | co -- ttbuild/goto |
ttbuildbind co<C-h> showkeysurl tabletopbuilds.com co
ttbuildbind: cob "Goto DnDBeyond.com" toposu https://www.dndbeyond.com
ttbuildbind: coc "Goto comments" cujs $id("comments").scrollIntoView()
ttbuildbind: col "Goto last level" cujs $$("h3,h3>span,h4").find(e=>e.id.match(/^level[-_]20[-_]/i)).scrollIntoView()
ttbuildbind: cor "Goto rpgbot.net" toposu https://rpgbot.net/dnd5/
ttbuildbind: cos "Goto dnd-spells.com" toposu! https://www.dnd-spells.com/spells
ttbuildbind: cot "Goto top level" toposu! https://tabletopbuilds.com

" | cs -- ttbuild/search |
definesearch ttbuild_search https://tabletopbuild.com/?s=%s

dndbbind cs<C-h> showkeysurl rpgbot.net cs
ttbuildbind: csb "Search DnDBeyond.com" fillcmdline dndb_search tab
ttbuildbind: css "Search TableTopBuilds.com" fillcmdline ttbuild_search tab
ttbuildbind: cs;s "Goto spell description" fillcmdline dndbspell tab

" ───────────────────────────────────────────────────────────────────────────────

fillcmdline dnd.tri LOADED
